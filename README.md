# ROBOT MOTION ENGINE

The Robot Motion Engine is a software framework for managing, planning, and controlling robot motion.
It provides a modular architecture that separates robot management, motion planning, scheduling, and control.

---

## Core Classes

### RobotManager

The `RobotManager` class is responsible for initializing and managing robot instances based on configuration files.
It serves as the entry point for setting up and running robot motion.

#### Functions

- `load`
    : Reads a **YAML** configuration file and maps its contents to a custom configuration structure.
      This configuration typically includes DH parameters, limits, and motion options.

- `start`
    : Starts the robot motion system.
      If the robot is not located at the home position, it first moves the robot to the home position before executing any motion.

- `stop`
    : Stops the robot motion safely and commands the robot to return to the home position.

##

### RobotController

The `RobotController` class controls a single robot to execute motions generated by the planner.
It also has a scheduler to manage states and a controller to compute control inputs.

#### Functions

- `load`
    : Initializes motion parameters from the custom configuration structure.
      The scheduler, planner, and controller are initialized.

- `home`
    : Moves the robot to its predefined home position.

- `start`
    : Begins executing motion commands provided by the controller until a stop command is published.

- `stop`
    : Stops motion execution and safely halts the robot.

- `is_collision`
    : Checks whether the robot collides with obstacles or with itself.

##

### Scheduler

The `Scheduer` class manages a sequence of robot actions.
Each action is represented as a state, following the concept of an FSM (Finite State Machine).
The scheduler determines which state is active and when transitions between states occur.

#### Functions

- `reset`
    : Resets the scheduler to its initial state.

- `tick`
    : Updates the current state of the FSM and triggers state transitions based on predefined conditions.

##

### Planner

The `Planner` class generates motions or paths required for each scheduler state.
It computes desired trajectories in task space or joint space.

#### Functions

- `reset`
    : Resets the planner's internal state and clears previously generated plans.

- `eval`
    : Evaluates and generates a motion or trajectory for the current state.

##

### Controller

The `Controller` class computes control inputs to track the desired trajectory generated by the planner.

#### Functions

- `reset`
    : Resets the controller's internal variables.

- `compute`
    : Computes control inputs (e.g., torques, velocities, or position commands) to follow the desired trajectory.

---

## User Configurations

- **name**
    : The name of the robot.

- **id**
    : The ID of the robot.

- **driver_ids**
    : The list of driver IDs that control the robot.

- **home_position**
    : The home position of the robot in joint space.

- **base_configuration**
    : The configuration of the robot base with respect to the world frame.

- **home_configuration**
    : The home configuration of the end-effector with respect to the base frame.

- **target_configuration**
    : The target configuration of the end-effector with respect to the world frame.
      Each target is required for each state.

- **screw_axes**
    : The screw axes of the robot.

- **self_collision**
    : The DH (Denavit-Hartenberg) parameters of the robot, including self-collision models.

---

## Inherited Classes

This section describes concrete implementations that inherit from the core classes.

### `RobotController` Implementations

#### `OpenChainRobotController`

#### `MobileRobotController`

### `Scheduler` Implementations

#### `FsmScheduler`

#### `GaitScheduler`

### `Planner` Implemetations

#### `TrajectoryPlanner`

#### `PathPlanner`

### `Controller` Implmentations

#### `PidController`

#### `OptimalController`

#### `ForceController`

---

## Types

### `robot_config_t`

```

uint8_t id
std::vector<uint8_t> driver_ids
std::vector<double> home_position
std::vector<std::array<3, double>> base_configuration
std::vector<std::array<3, double>> home_configuration
std::vector<std::vector<std::array<3, double>>> target_configuration
std::vector<std::array<6, double>> screw_axes
std::vector<std::array<4, double>> self_collision

```

